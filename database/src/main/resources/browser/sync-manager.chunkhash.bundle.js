(this.webpackJsonp=this.webpackJsonp||[]).push([[2],{1423:function(e,t,n){"use strict";n.r(t);var i=n(188),a=n(3),c=n(13);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(t){var n=t.dbConfig,a=t.serviceReadyCallback,c=t.onSyncCallback,o=t.disconnectCallback,u=void 0===o?null:o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object(i.c)(n),this.isServiceUp(a),this.onSync=c,this.onDisconnect=u}var t,n,u;return t=e,(n=[{key:"isServiceUp",value:function(e){var t=this;Object(i.f)().on("value",function(n){n.val()?(t._downTimer&&(clearTimeout(t._downTimer),delete t._downTimer),e(c.k)):t._downTimer=setTimeout(function(){return e(c.d)},1e4)})}},{key:"authCallBack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t?(this.serviceAuthenticated=!1,this.error=t,i&&i(t)):this.authenticateWithDataAndBind(e,n,i)}},{key:"authenticateWithDataAndBind",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.authData=e,Object(i.a)(this.authData.data_token,this.onDisconnect).then(function(i){t.serviceAuthenticated=!0,t.error=null,t.bindToResource(),n&&n(e)}).catch(function(e){t.serviceAuthenticated=!1,t.error=e,a&&a(e)})}},{key:"bindToResource",value:function(){var e=this;this.syncRef=Object(i.b)(this.authData.profile.user_id),this.syncRef.on("value",function(t){null===t.val()?Object(i.d)(e.authData.profile.user_id,{documents:[{client:Object(a.l)(),syncedAt:Date.now()}]}):e.setSyncData(t.val())})}},{key:"signOut",value:function(){Object(i.e)()}},{key:"setSyncData",value:function(e){this.onSync({key:this.authData.profile.user_id,syncObj:e,lastSyncedAt:new Date})}}])&&o(t.prototype,n),u&&o(t,u),e}();t.default=u}}]);